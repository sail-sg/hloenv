HloModule jit_prune_neighbor_list_dense.272

jit_vmap_vmap_remainder__.36 {
  Arg_0.37 = f32[100,1125,2]{2,1,0} parameter(0)
  Arg_1.38 = f32[] parameter(1)
  broadcast.42 = f32[100,1125,2]{2,1,0} broadcast(Arg_1.38), dimensions={}
  remainder.43 = f32[100,1125,2]{2,1,0} remainder(Arg_0.37, broadcast.42)
  constant.40 = f32[] constant(0)
  broadcast.41 = f32[100,1125,2]{2,1,0} broadcast(constant.40), dimensions={}
  compare.45 = pred[100,1125,2]{2,1,0} compare(remainder.43, broadcast.41), direction=LT
  constant.39 = f32[] constant(0)
  compare.46 = pred[] compare(Arg_1.38, constant.39), direction=LT
  broadcast.47 = pred[100,1125,2]{2,1,0} broadcast(compare.46), dimensions={}
  compare.48 = pred[100,1125,2]{2,1,0} compare(compare.45, broadcast.47), direction=NE
  compare.44 = pred[100,1125,2]{2,1,0} compare(remainder.43, broadcast.41), direction=NE
  and.49 = pred[100,1125,2]{2,1,0} and(compare.48, compare.44)
  broadcast.50 = f32[100,1125,2]{2,1,0} broadcast(Arg_1.38), dimensions={}
  add.51 = f32[100,1125,2]{2,1,0} add(remainder.43, broadcast.50)
  ROOT select.52 = f32[100,1125,2]{2,1,0} select(and.49, add.51, remainder.43)
}

region_0.56 {
  Arg_0.57 = f32[] parameter(0)
  Arg_1.58 = f32[] parameter(1)
  ROOT add.59 = f32[] add(Arg_0.57, Arg_1.58)
}

cumsum.64 {
  Arg_0.65 = s32[100,1125]{1,0} parameter(0)
  slice.164 = s32[100,1]{1,0} slice(Arg_0.65), slice={[0:100], [0:1]}
  slice.67 = s32[100,562]{1,0} slice(Arg_0.65), slice={[0:100:1], [0:1124:2]}
  slice.68 = s32[100,562]{1,0} slice(Arg_0.65), slice={[0:100:1], [1:1125:2]}
  add.69 = s32[100,562]{1,0} add(slice.67, slice.68)
  slice.157 = s32[100,1]{1,0} slice(add.69), slice={[0:100], [0:1]}
  slice.70 = s32[100,281]{1,0} slice(add.69), slice={[0:100:1], [0:561:2]}
  slice.71 = s32[100,281]{1,0} slice(add.69), slice={[0:100:1], [1:562:2]}
  add.72 = s32[100,281]{1,0} add(slice.70, slice.71)
  slice.149 = s32[100,1]{1,0} slice(add.72), slice={[0:100], [0:1]}
  slice.73 = s32[100,140]{1,0} slice(add.72), slice={[0:100:1], [0:280:2]}
  slice.74 = s32[100,140]{1,0} slice(add.72), slice={[0:100:1], [1:281:2]}
  add.75 = s32[100,140]{1,0} add(slice.73, slice.74)
  slice.142 = s32[100,1]{1,0} slice(add.75), slice={[0:100], [0:1]}
  slice.76 = s32[100,70]{1,0} slice(add.75), slice={[0:100:1], [0:139:2]}
  slice.77 = s32[100,70]{1,0} slice(add.75), slice={[0:100:1], [1:140:2]}
  add.78 = s32[100,70]{1,0} add(slice.76, slice.77)
  slice.134 = s32[100,1]{1,0} slice(add.78), slice={[0:100], [0:1]}
  slice.79 = s32[100,35]{1,0} slice(add.78), slice={[0:100:1], [0:69:2]}
  slice.80 = s32[100,35]{1,0} slice(add.78), slice={[0:100:1], [1:70:2]}
  add.81 = s32[100,35]{1,0} add(slice.79, slice.80)
  slice.126 = s32[100,1]{1,0} slice(add.81), slice={[0:100], [0:1]}
  slice.82 = s32[100,17]{1,0} slice(add.81), slice={[0:100:1], [0:34:2]}
  slice.83 = s32[100,17]{1,0} slice(add.81), slice={[0:100:1], [1:35:2]}
  add.84 = s32[100,17]{1,0} add(slice.82, slice.83)
  slice.119 = s32[100,1]{1,0} slice(add.84), slice={[0:100], [0:1]}
  slice.85 = s32[100,8]{1,0} slice(add.84), slice={[0:100:1], [0:16:2]}
  slice.86 = s32[100,8]{1,0} slice(add.84), slice={[0:100:1], [1:17:2]}
  add.87 = s32[100,8]{1,0} add(slice.85, slice.86)
  slice.112 = s32[100,1]{1,0} slice(add.87), slice={[0:100], [0:1]}
  slice.88 = s32[100,4]{1,0} slice(add.87), slice={[0:100:1], [0:7:2]}
  slice.89 = s32[100,4]{1,0} slice(add.87), slice={[0:100:1], [1:8:2]}
  add.90 = s32[100,4]{1,0} add(slice.88, slice.89)
  slice.104 = s32[100,1]{1,0} slice(add.90), slice={[0:100], [0:1]}
  slice.91 = s32[100,2]{1,0} slice(add.90), slice={[0:100:1], [0:3:2]}
  slice.92 = s32[100,2]{1,0} slice(add.90), slice={[0:100:1], [1:4:2]}
  add.93 = s32[100,2]{1,0} add(slice.91, slice.92)
  slice.97 = s32[100,1]{1,0} slice(add.93), slice={[0:100], [0:1]}
  constant.66 = s32[] constant(0)
  pad.98 = s32[100,2]{1,0} pad(slice.97, constant.66), padding=0_0_0x0_1_1
  slice.94 = s32[100,1]{1,0} slice(add.93), slice={[0:100:1], [0:1:2]}
  slice.95 = s32[100,1]{1,0} slice(add.93), slice={[0:100:1], [1:2:2]}
  add.96 = s32[100,1]{1,0} add(slice.94, slice.95)
  pad.99 = s32[100,2]{1,0} pad(add.96, constant.66), padding=0_0_0x1_0_1
  add.100 = s32[100,2]{1,0} add(pad.98, pad.99)
  slice.101 = s32[100,1]{1,0} slice(add.100), slice={[0:100], [0:1]}
  slice.102 = s32[100,1]{1,0} slice(add.90), slice={[0:100:1], [2:4:2]}
  add.103 = s32[100,1]{1,0} add(slice.101, slice.102)
  concatenate.105 = s32[100,2]{1,0} concatenate(slice.104, add.103), dimensions={1}
  pad.106 = s32[100,4]{1,0} pad(concatenate.105, constant.66), padding=0_0_0x0_1_1
  pad.107 = s32[100,4]{1,0} pad(add.100, constant.66), padding=0_0_0x1_0_1
  add.108 = s32[100,4]{1,0} add(pad.106, pad.107)
  slice.109 = s32[100,3]{1,0} slice(add.108), slice={[0:100], [0:3]}
  slice.110 = s32[100,3]{1,0} slice(add.87), slice={[0:100:1], [2:8:2]}
  add.111 = s32[100,3]{1,0} add(slice.109, slice.110)
  concatenate.113 = s32[100,4]{1,0} concatenate(slice.112, add.111), dimensions={1}
  pad.114 = s32[100,8]{1,0} pad(concatenate.113, constant.66), padding=0_0_0x0_1_1
  pad.115 = s32[100,8]{1,0} pad(add.108, constant.66), padding=0_0_0x1_0_1
  add.116 = s32[100,8]{1,0} add(pad.114, pad.115)
  slice.117 = s32[100,8]{1,0} slice(add.84), slice={[0:100:1], [2:17:2]}
  add.118 = s32[100,8]{1,0} add(add.116, slice.117)
  concatenate.120 = s32[100,9]{1,0} concatenate(slice.119, add.118), dimensions={1}
  pad.121 = s32[100,17]{1,0} pad(concatenate.120, constant.66), padding=0_0_0x0_0_1
  pad.122 = s32[100,17]{1,0} pad(add.116, constant.66), padding=0_0_0x1_1_1
  add.123 = s32[100,17]{1,0} add(pad.121, pad.122)
  slice.124 = s32[100,17]{1,0} slice(add.81), slice={[0:100:1], [2:35:2]}
  add.125 = s32[100,17]{1,0} add(add.123, slice.124)
  concatenate.127 = s32[100,18]{1,0} concatenate(slice.126, add.125), dimensions={1}
  pad.128 = s32[100,35]{1,0} pad(concatenate.127, constant.66), padding=0_0_0x0_0_1
  pad.129 = s32[100,35]{1,0} pad(add.123, constant.66), padding=0_0_0x1_1_1
  add.130 = s32[100,35]{1,0} add(pad.128, pad.129)
  slice.131 = s32[100,34]{1,0} slice(add.130), slice={[0:100], [0:34]}
  slice.132 = s32[100,34]{1,0} slice(add.78), slice={[0:100:1], [2:70:2]}
  add.133 = s32[100,34]{1,0} add(slice.131, slice.132)
  concatenate.135 = s32[100,35]{1,0} concatenate(slice.134, add.133), dimensions={1}
  pad.136 = s32[100,70]{1,0} pad(concatenate.135, constant.66), padding=0_0_0x0_1_1
  pad.137 = s32[100,70]{1,0} pad(add.130, constant.66), padding=0_0_0x1_0_1
  add.138 = s32[100,70]{1,0} add(pad.136, pad.137)
  slice.139 = s32[100,69]{1,0} slice(add.138), slice={[0:100], [0:69]}
  slice.140 = s32[100,69]{1,0} slice(add.75), slice={[0:100:1], [2:140:2]}
  add.141 = s32[100,69]{1,0} add(slice.139, slice.140)
  concatenate.143 = s32[100,70]{1,0} concatenate(slice.142, add.141), dimensions={1}
  pad.144 = s32[100,140]{1,0} pad(concatenate.143, constant.66), padding=0_0_0x0_1_1
  pad.145 = s32[100,140]{1,0} pad(add.138, constant.66), padding=0_0_0x1_0_1
  add.146 = s32[100,140]{1,0} add(pad.144, pad.145)
  slice.147 = s32[100,140]{1,0} slice(add.72), slice={[0:100:1], [2:281:2]}
  add.148 = s32[100,140]{1,0} add(add.146, slice.147)
  concatenate.150 = s32[100,141]{1,0} concatenate(slice.149, add.148), dimensions={1}
  pad.151 = s32[100,281]{1,0} pad(concatenate.150, constant.66), padding=0_0_0x0_0_1
  pad.152 = s32[100,281]{1,0} pad(add.146, constant.66), padding=0_0_0x1_1_1
  add.153 = s32[100,281]{1,0} add(pad.151, pad.152)
  slice.154 = s32[100,280]{1,0} slice(add.153), slice={[0:100], [0:280]}
  slice.155 = s32[100,280]{1,0} slice(add.69), slice={[0:100:1], [2:562:2]}
  add.156 = s32[100,280]{1,0} add(slice.154, slice.155)
  concatenate.158 = s32[100,281]{1,0} concatenate(slice.157, add.156), dimensions={1}
  pad.159 = s32[100,562]{1,0} pad(concatenate.158, constant.66), padding=0_0_0x0_1_1
  pad.160 = s32[100,562]{1,0} pad(add.153, constant.66), padding=0_0_0x1_0_1
  add.161 = s32[100,562]{1,0} add(pad.159, pad.160)
  slice.162 = s32[100,562]{1,0} slice(Arg_0.65), slice={[0:100:1], [2:1125:2]}
  add.163 = s32[100,562]{1,0} add(add.161, slice.162)
  concatenate.165 = s32[100,563]{1,0} concatenate(slice.164, add.163), dimensions={1}
  pad.166 = s32[100,1125]{1,0} pad(concatenate.165, constant.66), padding=0_0_0x0_0_1
  pad.167 = s32[100,1125]{1,0} pad(add.161, constant.66), padding=0_0_0x1_1_1
  ROOT add.168 = s32[100,1125]{1,0} add(pad.166, pad.167)
}

jit__cumulative_reduction.169 {
  Arg_0.170 = pred[100,1125]{1,0} parameter(0)
  convert.171 = s32[100,1125]{1,0} convert(Arg_0.170)
  ROOT call.172 = s32[100,1125]{1,0} call(convert.171), to_apply=cumsum.64
}

jit__where.175 {
  Arg_0.176 = pred[100,1125]{1,0} parameter(0)
  Arg_1.177 = s32[100,1125]{1,0} parameter(1)
  Arg_2.178 = s32[] parameter(2)
  broadcast.179 = s32[100,1125]{1,0} broadcast(Arg_2.178), dimensions={}
  ROOT select.180 = s32[100,1125]{1,0} select(Arg_0.176, Arg_1.177, broadcast.179)
}

region_1.195 {
  Arg_0.196 = s32[] parameter(0)
  ROOT Arg_1.197 = s32[] parameter(1)
}

region_2.201 {
  Arg_0.202 = s32[] parameter(0)
  Arg_1.203 = s32[] parameter(1)
  ROOT maximum.204 = s32[] maximum(Arg_0.202, Arg_1.203)
}

ENTRY main.208 {
  constant.15 = s32[] constant(100)
  broadcast.16 = s32[100,1125]{1,0} broadcast(constant.15), dimensions={}
  iota.182 = s32[100]{0} iota(), iota_dimension=0
  reshape.183 = s32[100,1]{1,0} reshape(iota.182)
  constant.11 = s32[] constant(0)
  broadcast.12 = s32[100,1]{1,0} broadcast(constant.11), dimensions={}
  compare.184 = pred[100,1]{1,0} compare(reshape.183, broadcast.12), direction=LT
  constant.9 = s32[] constant(100)
  broadcast.10 = s32[100,1]{1,0} broadcast(constant.9), dimensions={}
  add.185 = s32[100,1]{1,0} add(reshape.183, broadcast.10)
  select.186 = s32[100,1]{1,0} select(compare.184, add.185, reshape.183)
  reshape.190 = s32[100]{0} reshape(select.186)
  broadcast.191 = s32[100,1125]{1,0} broadcast(reshape.190), dimensions={0}
  reshape.192 = s32[100,1125,1]{2,1,0} reshape(broadcast.191)
  Arg_0.1 = f32[100,2]{1,0} parameter(0)
  negate.28 = f32[100,2]{1,0} negate(Arg_0.1)
  reshape.30 = f32[100,1,2]{2,1,0} reshape(negate.28)
  broadcast.31 = f32[100,1,2]{2,1,0} broadcast(reshape.30), dimensions={0,1,2}
  reshape.32 = f32[100,2]{1,0} reshape(broadcast.31)
  broadcast.33 = f32[100,1125,2]{2,1,0} broadcast(reshape.32), dimensions={0,2}
  Arg_1.2 = s32[100,1125]{1,0} parameter(1)
  constant.7 = s32[] constant(0)
  broadcast.8 = s32[100,1125]{1,0} broadcast(constant.7), dimensions={}
  compare.23 = pred[100,1125]{1,0} compare(Arg_1.2, broadcast.8), direction=LT
  add.24 = s32[100,1125]{1,0} add(Arg_1.2, broadcast.16)
  select.25 = s32[100,1125]{1,0} select(compare.23, add.24, Arg_1.2)
  reshape.26 = s32[100,1125,1]{2,1,0} reshape(select.25)
  gather.27 = f32[100,1125,2]{2,1,0} gather(Arg_0.1, reshape.26), offset_dims={2}, collapsed_slice_dims={0}, start_index_map={0}, index_vector_dim=2, slice_sizes={1,2}
  negate.29 = f32[100,1125,2]{2,1,0} negate(gather.27)
  subtract.34 = f32[100,1125,2]{2,1,0} subtract(broadcast.33, negate.29)
  constant.20 = f32[] constant(5)
  broadcast.21 = f32[100,1125,2]{2,1,0} broadcast(constant.20), dimensions={}
  add.35 = f32[100,1125,2]{2,1,0} add(subtract.34, broadcast.21)
  constant.22 = f32[] constant(10)
  call.53 = f32[100,1125,2]{2,1,0} call(add.35, constant.22), to_apply=jit_vmap_vmap_remainder__.36
  subtract.54 = f32[100,1125,2]{2,1,0} subtract(call.53, broadcast.21)
  multiply.55 = f32[100,1125,2]{2,1,0} multiply(subtract.54, subtract.54)
  constant.19 = f32[] constant(0)
  reduce.60 = f32[100,1125]{1,0} reduce(multiply.55, constant.19), dimensions={2}, to_apply=region_0.56
  constant.17 = f32[] constant(6.75999928)
  broadcast.18 = f32[100,1125]{1,0} broadcast(constant.17), dimensions={}
  compare.61 = pred[100,1125]{1,0} compare(reduce.60, broadcast.18), direction=LT
  compare.62 = pred[100,1125]{1,0} compare(Arg_1.2, broadcast.16), direction=LT
  and.63 = pred[100,1125]{1,0} and(compare.61, compare.62)
  call.173 = s32[100,1125]{1,0} call(and.63), to_apply=jit__cumulative_reduction.169
  constant.13 = s32[] constant(1)
  broadcast.14 = s32[100,1125]{1,0} broadcast(constant.13), dimensions={}
  subtract.174 = s32[100,1125]{1,0} subtract(call.173, broadcast.14)
  constant.4 = s32[] constant(1124)
  call.181 = s32[100,1125]{1,0} call(and.63, subtract.174, constant.4), to_apply=jit__where.175
  compare.187 = pred[100,1125]{1,0} compare(call.181, broadcast.8), direction=LT
  constant.5 = s32[] constant(1125)
  broadcast.6 = s32[100,1125]{1,0} broadcast(constant.5), dimensions={}
  add.188 = s32[100,1125]{1,0} add(call.181, broadcast.6)
  select.189 = s32[100,1125]{1,0} select(compare.187, add.188, call.181)
  reshape.193 = s32[100,1125,1]{2,1,0} reshape(select.189)
  concatenate.194 = s32[100,1125,2]{2,1,0} concatenate(reshape.192, reshape.193), dimensions={2}
  scatter.198 = s32[100,1125]{1,0} scatter(broadcast.16, concatenate.194, Arg_1.2), update_window_dims={}, inserted_window_dims={0,1}, scatter_dims_to_operand_dims={0,1}, index_vector_dim=2, to_apply=region_1.195
  slice.206 = s32[100,1124]{1,0} slice(scatter.198), slice={[0:100], [0:1124]}
  slice.199 = s32[100,1]{1,0} slice(call.173), slice={[0:100], [1124:1125]}
  reshape.200 = s32[100]{0} reshape(slice.199)
  constant.3 = s32[] constant(-2147483648)
  reduce.205 = s32[] reduce(reshape.200, constant.3), dimensions={0}, to_apply=region_2.201
  ROOT tuple.207 = (s32[100,1124]{1,0}, s32[]) tuple(slice.206, reduce.205)
}

